plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
legend(0.95, 0, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# rios_data_token2 <- rios_data_token2it %>%
#   separate(it_tokens_2w, c("word1", "word2"), sep = " ")
rios_2w_net_2016.g <- rios_data_token2 %>%
filter(dei_related == TRUE & Year == 2016) %>%
count(word1, word2, sort = TRUE) %>%
graph_from_data_frame()
V(rios_2w_net_2016.g)[V(rios_2w_net_2016.g)$name %in% updated_DEI$allwords]$color<-"#1f78b4"
V(rios_2w_net_2016.g)[!V(rios_2w_net_2016.g)$name %in% updated_DEI$allwords]$color<- "#a6cee3"
#stemmed version
rios_2w_net_2016_stemmed.g <- rios_data_token2 %>%
filter(dei_related == TRUE & Year == 2016) %>%
mutate(stem1 = wordStem(`word1`, language = "en")) %>%
mutate(stem2 = wordStem(`word2`, language = "en")) %>%
count(stem1, stem2, sort = TRUE) %>%
graph_from_data_frame()
V(rios_2w_net_2016_stemmed.g)[V(rios_2w_net_2016_stemmed.g)$name %in% updated_DEI$allwords]$color<-"#1f78b4"
V(rios_2w_net_2016_stemmed.g)[!V(rios_2w_net_2016_stemmed.g)$name %in% updated_DEI$allwords]$color<- "#a6cee3"
set.seed(20181005)
#original net
png(file="2w2016.png",res=1000, width=10000, height=10000, pointsize = 9)
plot(rios_2w_net_2016.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2016.g)$n, vertex.size=log(degree(rios_2w_net_2016.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2016")
legend(0.95, 0, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
#stemmed net
png(file="2w2016_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
plot(rios_2w_net_2016_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2016_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2016_stemmed.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2016")
legend(0.95, 0, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=1000, width=10000, height=10000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(0.95, 0.5, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
#stemmed net
png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
legend(0.95, 0.5, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=1000, width=10000, height=10000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
#stemmed net
png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
# Store all installed packages
ya_loaded <- (.packages())
# Check whether required packages are already installed and grab only those that still need installation
need_load<-my_packages[!(my_packages %in% ya_loaded)]
# Load required packages
lapply(need_load, require, character.only = TRUE)
#extracting the edgelist(two-word pairs) and create a igraph object from it
rios_2w_net_2014.g <- rios_data_token2 %>%
filter(dei_related == TRUE & Year == 2014) %>%
count(word1, word2, sort = TRUE) %>%
graph_from_data_frame()
V(rios_2w_net_2014.g)[V(rios_2w_net_2014.g)$name %in% updated_DEI$allwords]$shape<-"circle"
V(rios_2w_net_2014.g)[!V(rios_2w_net_2014.g)$name %in% updated_DEI$allwords]$shape<- "square"
V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$color<-brewer.pal(7, "GnBu")[3:7]
V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[-c(1:5)]]$color<-"#a6cee3"
# #stemmed version
# rios_2w_net_2014_stemmed.g <- rios_data_token2 %>%
#   filter(dei_related == TRUE & Year == 2014) %>%
#   mutate(stem1 = wordStem(`word1`, language = "en")) %>%
#   mutate(stem2 = wordStem(`word2`, language = "en")) %>%
#   count(stem1, stem2, sort = TRUE) %>%
#   graph_from_data_frame()
#
# V(rios_2w_net_2014_stemmed.g)[V(rios_2w_net_2014_stemmed.g)$name %in% updated_DEI$allwords]$shape<-"circle"
# V(rios_2w_net_2014_stemmed.g)[!V(rios_2w_net_2014_stemmed.g)$name %in% updated_DEI$allwords]$shape<- "square"
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=1000, width=10000, height=10000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.95, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
rios_2w_net_2018.g <- rios_data_token2 %>%
filter(dei_related == TRUE & Year == 2018) %>%
count(word1, word2, sort = TRUE) %>%
graph_from_data_frame()
V(rios_2w_net_2018.g)[V(rios_2w_net_2018.g)$name %in% updated_DEI$allwords]$shape<-"circle"
V(rios_2w_net_2018.g)[!V(rios_2w_net_2018.g)$name %in% updated_DEI$allwords]$shape<- "square"
V(rios_2w_net_2018.g)[sort(degree(rios_2w_net_2018.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$color<-brewer.pal(7, "GnBu")[3:7]
V(rios_2w_net_2018.g)[sort(degree(rios_2w_net_2018.g), decreasing = TRUE, index.return=TRUE)$ix[-c(1:5)]]$color<-"#a6cee3"
#
# #stemmed version
# rios_2w_net_2018_stemmed.g <- rios_data_token2 %>%
#   filter(dei_related == TRUE & Year == 2018) %>%
#   mutate(stem1 = wordStem(`word1`, language = "en")) %>%
#   mutate(stem2 = wordStem(`word2`, language = "en")) %>%
#   count(stem1, stem2, sort = TRUE) %>%
#   graph_from_data_frame()
#
# V(rios_2w_net_2018_stemmed.g)[V(rios_2w_net_2018_stemmed.g)$name %in% updated_DEI$allwords]$color<-"#1f78b4"
# V(rios_2w_net_2018_stemmed.g)[!V(rios_2w_net_2018_stemmed.g)$name %in% updated_DEI$allwords]$color<- "#a6cee3"
set.seed(20181005)
png(file="2w2018.png",res=1000, width=10000, height=10000, pointsize = 9)
plot(rios_2w_net_2018.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2018.g)$n, vertex.size=log(degree(rios_2w_net_2018.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2018")
legend(-0.95, 1, legend=c(V(rios_2w_net_2018.g)[sort(degree(rios_2w_net_2018.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
#
# png(file="2w2018_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2018_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2018_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2018_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2018")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
rios_2w_net_2019.g <- rios_data_token2 %>%
filter(dei_related == TRUE & Year == 2019) %>%
count(word1, word2, sort = TRUE) %>%
graph_from_data_frame()
V(rios_2w_net_2019.g)[V(rios_2w_net_2019.g)$name %in% updated_DEI$allwords]$shape<-"circle"
V(rios_2w_net_2019.g)[!V(rios_2w_net_2019.g)$name %in% updated_DEI$allwords]$shape<- "square"
V(rios_2w_net_2019.g)[sort(degree(rios_2w_net_2019.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$color<-brewer.pal(7, "GnBu")[3:7]
V(rios_2w_net_2019.g)[sort(degree(rios_2w_net_2019.g), decreasing = TRUE, index.return=TRUE)$ix[-c(1:5)]]$color<-"#a6cee3"
# #stemmed version
# rios_2w_net_2019_stemmed.g <- rios_data_token2 %>%
#   filter(dei_related == TRUE & Year == 2019) %>%
#   mutate(stem1 = wordStem(`word1`, language = "en")) %>%
#   mutate(stem2 = wordStem(`word2`, language = "en")) %>%
#   count(stem1, stem2, sort = TRUE) %>%
#   graph_from_data_frame()
#
# V(rios_2w_net_2019_stemmed.g)[V(rios_2w_net_2019_stemmed.g)$name %in% updated_DEI$allwords]$color<-"#1f78b4"
# V(rios_2w_net_2019_stemmed.g)[!V(rios_2w_net_2019_stemmed.g)$name %in% updated_DEI$allwords]$color<- "#a6cee3"
set.seed(20181005)
#original net
png(file="2w2019.png",res=1000, width=10000, height=10000, pointsize = 9)
plot(rios_2w_net_2019.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2019.g)$n, vertex.size=log(degree(rios_2w_net_2019.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2019")
legend(-0.95, 1, legend=c(V(rios_2w_net_2019.g)[sort(degree(rios_2w_net_2019.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
#
# #stemmed version
# png(file="2w2019_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
# plot(rios_2w_net_2019_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2019_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2019_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2019")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
rios_2w_net_2022.g <- rios_data_token2 %>%
filter(dei_related == TRUE & Year == 2022) %>%
count(word1, word2, sort = TRUE) %>%
graph_from_data_frame()
V(rios_2w_net_2022.g)[V(rios_2w_net_2022.g)$name %in% updated_DEI$allwords]$shape<-"circle"
V(rios_2w_net_2019.g)[!V(rios_2w_net_2022.g)$name %in% updated_DEI$allwords]$shape<- "square"
rios_2w_net_2022.g <- rios_data_token2 %>%
filter(dei_related == TRUE & Year == 2022) %>%
count(word1, word2, sort = TRUE) %>%
graph_from_data_frame()
V(rios_2w_net_2022.g)[V(rios_2w_net_2022.g)$name %in% updated_DEI$allwords]$shape<-"circle"
V(rios_2w_net_2022.g)[!V(rios_2w_net_2022.g)$name %in% updated_DEI$allwords]$shape<- "square"
V(rios_2w_net_2022.g)[sort(degree(rios_2w_net_2022.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$color<-brewer.pal(7, "GnBu")[3:7]
V(rios_2w_net_2022.g)[sort(degree(rios_2w_net_2022.g), decreasing = TRUE, index.return=TRUE)$ix[-c(1:5)]]$color<-"#a6cee3"
# #stemmed version
# rios_2w_net_2022_stemmed.g <- rios_data_token2 %>%
#   filter(dei_related == TRUE & Year == 2022) %>%
#   mutate(stem1 = wordStem(`word1`, language = "en")) %>%
#   mutate(stem2 = wordStem(`word2`, language = "en")) %>%
#   count(stem1, stem2, sort = TRUE) %>%
#   graph_from_data_frame()
#
# V(rios_2w_net_2022_stemmed.g)[V(rios_2w_net_2022_stemmed.g)$name %in% updated_DEI$allwords]$color<-"#1f78b4"
# V(rios_2w_net_2022_stemmed.g)[!V(rios_2w_net_2022_stemmed.g)$name %in% updated_DEI$allwords]$color<- "#a6cee3"
set.seed(20181005)
png(file="2w2022.png",res=1000, width=10000, height=10000, pointsize = 9)
plot(rios_2w_net_2022.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2022.g)$n, vertex.size=log(degree(rios_2w_net_2022.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2022")
legend(-0.95, 1, legend=c(V(rios_2w_net_2022.g)[sort(degree(rios_2w_net_2022.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# png(file="2w2022_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2022_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2022_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2022_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2022")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=1000, width=5000, height=5000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
# Store all installed packages
ya_loaded <- (.packages())
# Check whether required packages are already installed and grab only those that still need installation
need_load<-my_packages[!(my_packages %in% ya_loaded)]
# Load required packages
lapply(need_load, require, character.only = TRUE)
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=1000, width=5000, height=5000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.95, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=500, width=5000, height=5000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.95, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=1000, width=5000, height=5000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.95, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=800, width=5000, height=5000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.95, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=800, width=5000, height=5000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-1, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=800, width=5000, height=5000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.9, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=1000, width=7000, height=7000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.9, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=1000, width=7000, height=7000, pointsize = 8)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.9, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=600, width=1000, height=1000, pointsize = 8)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.9, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=400, width=1000, height=1000, pointsize = 8)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.9, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=500, width=3000, height=3000, pointsize = 8)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.9, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=500, width=3000, height=3000, pointsize = 5)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.9, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=500, width=3000, height=3000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.9, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 1, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=500, width=3000, height=3000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.9, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 2, cex = 0.5, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=500, width=3000, height=3000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.9, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 0.5, cex = 0.5, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=1000, width=3000, height=3000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.9, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 0.5, cex = 0.5, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=600, width=3000, height=3000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.9, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 0.5, cex = 0.5, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
#Visualization
set.seed(20181005)
#original net
png(file="2w2014.png",res=600, width=3000, height=3000, pointsize = 9)
plot(rios_2w_net_2014.g, layout=layout_with_kk, edge.width =E(rios_2w_net_2014.g)$n, vertex.size=log(degree(rios_2w_net_2014.g)),vertex.label.degree=-pi/2,
vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) Word Relationship in 2014")
legend(-0.9, 1, legend=c(V(rios_2w_net_2014.g)[sort(degree(rios_2w_net_2014.g), decreasing = TRUE, index.return=TRUE)$ix[1:5]]$name,"1DEI", "Others")  , col = c(brewer.pal(7, "GnBu")[3:7],"black", "black") , bty = "n", pch=c(19, 19, 19, 19, 19, 1, 0) , lty =c(0, 0, 0, 0, 0, 0, 0),  pt.cex = 0.5, cex = 0.5, text.col=c(brewer.pal(7, "GnBu")[3:7],"black", "black") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
dev.off()
# #stemmed net
# png(file="2w2014_stemmed.png",res=1000, width=10000, height=10000, pointsize = 9)
#
# plot(rios_2w_net_2014_stemmed.g,layout=layout_with_kk, edge.width =E(rios_2w_net_2014_stemmed.g)$n, vertex.size=log(degree(rios_2w_net_2014_stemmed.g)),vertex.label.degree=-pi/2,
# vertex.label.dist=0.2,vertex.label.cex=0.3, edge.arrow.size=0.3, edge.arrow.width=0.2, main="Network of (DEI Related) stemmed Word Relationship in 2014")
#
# legend(0.95, 1, legend=c("2DEI","1DEI")  , col = c("#a6cee3", "#1f78b4") , bty = "n", pch=c(20, 20) , lty =c(0, 0),  pt.cex = 2, cex = 1, text.col=c("#a6cee3", "#1f78b4") ,xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,adj = c(0, 0.5), horiz = FALSE)
# dev.off()
setwd("/Users/zhaoyuhao/Desktop/College/Research/RIOS---CourseSource-Research/CourseSource")
setwd("/Users/zhaoyuhao/Desktop/College/Research/RIOS---CourseSource-Research/CourseSource")
setwd("/Users/zhaoyuhao/Desktop/College/Research/RIOS---CourseSource-Research")
setwd("/Users/zhaoyuhao/Desktop/College/Research")
