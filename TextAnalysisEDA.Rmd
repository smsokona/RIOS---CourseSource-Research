---
title: "RIOS Research"
output: html_document
date: "2022-12-14"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r loading data}
#install.packages("skimr")
#install.packages("tidyverse")
#install.packages("tidytext")
#install.packages("stopwords")
library(skimr)
library(tidyverse)
library(tidytext)
library(ggplot2)
library(readr)
library(stopwords)
rios_data <- read_csv("RIOS Research - Course Source - Sheet1 2.csv")
dei_keywords <- read_csv("SJEDI_words 2022-12-20 18_03_42.csv")
rios_data$`Inclusive Teaching  included?`[12] = "No"

```

## Plots


```{r}
#word count over time plot 
#rios_data %>%
 # ggplot(aes(rios_data$Year, rios_data$`Word Count of Inclusive Teaching?`)) + 
  #  geom_boxplot(na.rm = TRUE) +
   # labs(x = "Year", y = "Word count of Inclusive Teaching Section",
  #title = "Word Count of Inlcusive Teaching Sections Over Time")


  boxplot(`Word Count of Inclusive Teaching?`~Year,
          data=rios_data,
          main="Word Count of Inlcusive Teaching Sections Over Time",
          xlab="Year",
          ylab="Word count of Inclusive Teaching Section",
          horizontal = TRUE)



```


```{r text cleaning, echo=FALSE}
#diversity related words from the 'keyword themes' column!
diversity_related <- c("diversity", "bias", "confirmation bias", "cognitive bias", "social justice", "broader impacts", "racism", "identity", "equity", "inclusivity", "environmental justice", "inclusion", "belonging")

#adding the vector above to the CSV dei_keywords
for (x in 1:13){
  dei_keywords[nrow(dei_keywords) + 1,] = diversity_related[x]
}

rios_data$article_num <- c(1:nrow(rios_data))
example <- tibble(text = test1) #bring the data into a form that facilitates manipulation: a tibble

example %>% 
  pull(text) %>% 
  str_split(pattern = " ")

words <- example %>%
  unnest_tokens(output = words, 
                input = text)

#applying to df to see output 
rios_data_tokenized <- rios_data %>%
  unnest_tokens(output = Words, input = `Inclusive Teaching Description`)

#glimpse(rios_data_tokenized)

#removing all rows with any punctuation, digits, or "stopwords" (~20k rows total)
strings <- c("[:punct:]", "[:digit:]","\\(","\\)")
stopwords_vec <- stopwords(language = "en")

#removed ~777 rows
rios_data_tokenized <- rios_data_tokenized %>%
  filter(!str_detect(Words, paste(strings, collapse = "|")))

#removed ~19,663 rows
rios_data_tokenized <- rios_data_tokenized %>%
  filter(!Words %in% stopwords_vec) 

```

```{r}
#EDA of words 

rios_data_tokenized %>%
  group_by(article_num, Words) %>%
  count(Words, sort = TRUE)

SJEDI_words_2022_12_20_18_03_42$dei_related = NA

SJEDI_words_2022_12_20_18_03_42 %>%
  mutate(dei_related = case_when(
    str_detect(Test2, SJEDI_words_2022_12_20_18_03_42$SJEDI_keyword[y]) ~ "Yes",
    TRUE ~ "No"
    )
  )

dei_keywords$dei_related = NA

sapply(Test2, function(x) any(sapply(SJEDI_words_2022_12_20_18_03_42, str_detect, string = x)))


str_detect(Test2, paste(SJEDI_words_2022_12_20_18_03_42, collapse = '|'))

  for (y in 1:44) {
    dei_keywords$dei_related[y] = ifelse(sapply(Test2, function(x) any(sapply(dei_keywords[y,1], str_detect, string = x))), "Yes", "No")
  }

d = toString(dei_keywords[33,1])
str_detect(Test2[45],d) #test2[45] = "bias"

```



